# 文档编辑器和甘特图使用指南

本指南介绍如何使用ProManage的文档编辑器和甘特图功能。

---

## 📝 文档编辑器

### 访问编辑器

1. 进入文档管理页面
2. 点击文档列表中的"编辑"按钮
3. 或访问 `/documents/:id/edit`

### 功能特性

#### 1. 双编辑器模式

**富文本模式**:
- 适合非技术用户
- 所见即所得
- 丰富的格式化选项
- 支持表格、图片、链接等

**Markdown模式**:
- 适合技术用户
- 轻量级语法
- 代码高亮
- 实时预览

**切换方式**: 点击顶部的"富文本"或"Markdown"按钮

#### 2. 自动保存

- 编辑内容后5秒自动保存
- 顶部显示保存状态
- 防止数据丢失

#### 3. 图片上传

支持三种上传方式:
1. **拖拽上传**: 直接拖拽图片到编辑器
2. **粘贴上传**: 复制图片后粘贴（Ctrl+V）
3. **选择上传**: 点击工具栏的图片按钮

#### 4. 冲突检测

当检测到版本冲突时，系统会提示三种处理方式:
- **使用服务器版本**: 放弃本地修改
- **使用本地版本**: 覆盖服务器版本
- **手动合并**: 高级用户选项

### 快捷键

| 操作 | 快捷键 |
|------|--------|
| 保存 | Ctrl+S |
| 粗体 | Ctrl+B |
| 斜体 | Ctrl+I |
| 撤销 | Ctrl+Z |
| 重做 | Ctrl+Y |

### 最佳实践

1. **定期保存**: 虽然有自动保存，但重要修改后建议手动保存
2. **使用标题**: 合理使用标题层级，便于文档结构化
3. **图片优化**: 上传前压缩大图片，提升加载速度
4. **版本管理**: 重大修改前建议创建新版本

---

## 📊 甘特图

### 访问甘特图

1. 进入任务管理页面
2. 切换到"甘特图"视图
3. 或在项目详情页的"任务"Tab中选择甘特图

### 功能特性

#### 1. 任务展示

**列信息**:
- 任务名称（树形结构）
- 开始时间
- 持续时间
- 负责人
- 进度百分比

**时间轴**:
- 按天/周/月显示
- 可缩放查看
- 支持滚动

#### 2. 拖拽操作

**调整时间**:
- 拖动任务条左右移动
- 改变任务开始时间

**调整持续时间**:
- 拖动任务条边缘
- 改变任务持续时间

**创建依赖**:
- 从任务A拖动到任务B
- 创建依赖关系

#### 3. 依赖关系

支持4种依赖类型:
- **FS (Finish-to-Start)**: A完成后B开始
- **SS (Start-to-Start)**: A开始时B开始
- **FF (Finish-to-Finish)**: A完成时B完成
- **SF (Start-to-Finish)**: A开始后B完成

#### 4. 关键路径

**功能**:
- 自动计算关键路径
- 红色高亮显示
- 帮助识别项目瓶颈

**开启方式**: 勾选工具栏的"显示关键路径"

#### 5. 导出功能

**导出PDF**:
1. 点击工具栏的"导出PDF"按钮
2. 等待生成（约3秒）
3. 自动下载PDF文件

**导出图片**:
1. 点击工具栏的"导出图片"按钮
2. 等待生成（约2秒）
3. 自动下载PNG文件

**用途**:
- 项目汇报
- 进度展示
- 文档归档

### 工具栏功能

| 按钮 | 功能 |
|------|------|
| 放大 | 放大时间轴 |
| 缩小 | 缩小时间轴 |
| 适应屏幕 | 自动调整显示范围 |
| 关键路径 | 开关关键路径显示 |
| 依赖关系 | 开关依赖线显示 |
| 导出PDF | 导出为PDF文件 |
| 导出图片 | 导出为PNG图片 |

### 任务样式

**优先级颜色**:
- 🔴 高优先级: 红色
- 🟠 中优先级: 蓝色
- 🟢 低优先级: 绿色

**状态样式**:
- 进行中: 蓝色
- 已完成: 半透明
- 关键任务: 红色加粗

### 最佳实践

1. **合理规划**: 创建任务前先规划好依赖关系
2. **及时更新**: 任务进度变化时及时更新
3. **关注关键路径**: 重点关注关键路径上的任务
4. **定期导出**: 定期导出甘特图作为项目记录

---

## 🔧 技术说明

### 文档编辑器

**技术栈**:
- TinyMCE: 富文本编辑器
- md-editor-v3: Markdown编辑器
- lodash-es: 防抖函数

**浏览器要求**:
- Chrome 90+
- Firefox 88+
- Edge 90+
- Safari 14+

### 甘特图

**技术栈**:
- dhtmlx-gantt: 甘特图核心库
- html2canvas: 截图工具
- jsPDF: PDF生成

**性能指标**:
- 100任务渲染: < 1秒
- 500任务渲染: < 3秒
- 拖拽响应: < 100ms

---

## ❓ 常见问题

### 文档编辑器

**Q: 自动保存失败怎么办？**  
A: 检查网络连接，手动点击保存按钮。如果持续失败，请联系管理员。

**Q: 如何恢复之前的版本？**  
A: 在文档详情页的"版本历史"中选择要恢复的版本，点击"回滚"。

**Q: 图片上传失败？**  
A: 检查图片大小（建议<5MB）和格式（支持JPG、PNG、GIF）。

**Q: 富文本和Markdown可以互转吗？**  
A: 目前不支持自动转换，切换模式时内容会保留但格式可能丢失。

### 甘特图

**Q: 为什么拖拽不生效？**  
A: 确保有编辑权限，且任务状态允许修改。

**Q: 如何删除依赖关系？**  
A: 点击依赖线，按Delete键或右键选择删除。

**Q: 导出的PDF不清晰？**  
A: 系统已使用2倍清晰度，如果仍不满意，可以尝试导出图片后自行转换。

**Q: 大量任务时卡顿？**  
A: 系统已优化性能，支持500+任务流畅显示。如果仍卡顿，建议分批查看。

---

## 📞 技术支持

如有问题，请联系:
- 技术支持邮箱: support@promanage.com
- 在线文档: https://docs.promanage.com
- 问题反馈: https://github.com/promanage/issues

---

**文档版本**: V1.0  
**更新时间**: 2025-01-06  
**适用版本**: ProManage V1.0+
